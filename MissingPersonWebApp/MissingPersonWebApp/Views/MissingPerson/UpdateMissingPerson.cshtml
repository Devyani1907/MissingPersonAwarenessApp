@model MissingPersonWebApp.Models.MissingPersonModel

@{
    ViewBag.Title = "UpdateMissingPerson";
}



<link href="~/css/CSS/animate.min.css" rel="stylesheet" />
<link href="~/css/CSS/bootstrap.min.css" rel="stylesheet" />
<link href="~/css/CSS/font-awesome.min.css" rel="stylesheet" />
<link href="~/css/CSS/main.css" rel="stylesheet" />
<link href="~/css/CSS/owl.carousel.css" rel="stylesheet" />
<link href="~/css/CSS/responsive.css" rel="stylesheet" />
<link href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css" rel="stylesheet" />

<style>

    .switch {
        position: relative;
        display: inline-block;
        width: 60px;
        height: 34px;
    }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        -webkit-transition: .4s;
        transition: .4s;
    }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            -webkit-transition: .4s;
            transition: .4s;
        }

    input:checked + .slider {
        background-color: #b3340e;
    }

    input:focus + .slider {
        box-shadow: 0 0 1px #2196F3;
    }

    input:checked + .slider:before {
        -webkit-transform: translateX(26px);
        -ms-transform: translateX(26px);
        transform: translateX(26px);
    }

    /* Rounded sliders */
    .slider.round {
        border-radius: 34px;
    }

        .slider.round:before {
            border-radius: 50%;
        }

    .center {
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 20%;
    }


    .dropdown {
        overflow: hidden;
        color: blue;
    }

        .dropdown .dropbtn {
            font-size: 16px;
            border: none;
            outline: none;
            color: blue;
            padding: 14px 16px;
            background-color: inherit;
            font-family: inherit;
            margin: 0;
        }



    .dropdown-content {
        display: none;
        background-color: #f9f9f9;
        min-width: 50px;
        margin-left: -100px;
    }

        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            text-align: right;
        }

            .dropdown-content a:hover {
                background-color: #ddd;
            }

    .dropdown:hover .dropdown-content {
        display: block;
    }
</style>

<section id="hero-area">
    <img class="img-responsive" src="~/Image/header1.png" alt="">
</section>

<div class="container body-content">
    <nav id="navigation">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="block">
                        <nav class="navbar navbar-default">
                            <div class="container-fluid">
                                <!-- Brand and toggle get grouped for better mobile display -->
                                <div class="navbar-header">
                                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                                        <span class="sr-only">Toggle navigation</span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                        <span class="icon-bar"></span>
                                    </button>
                                    @*<a class="navbar-brand" href="#">
                                            <img src="~/Image/logo.png" alt="Logo">
                                        </a>*@

                                </div>

                                <!-- Collect the nav links, forms, and other content for toggling -->
                                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                                    <div class="pull-right">
                                        <span><button class="btn btn-outline-light"><a href="/Dashboard/Dashboard">Home</a></button></span>&nbsp&nbsp&nbsp
                                        <span><button class="btn btn-outline-light"><a href="">About us</a></button></span>&nbsp&nbsp&nbsp
                                        <span><button class="btn btn-outline-light"><a href="">Blog</a></button></span>&nbsp&nbsp&nbsp
                                        <span><button class="btn btn-outline-light"><a href="">Contacts</a></button></span>&nbsp&nbsp&nbsp
                                        <span><button class="btn btn-outline-light"><a href="/MissingPerson/ManageMissingPerson">Manage Missing Person</a></button></span>
                                    </div>
                                </div><!-- /.navbar-collapse -->
                            </div><!-- /.container-fluid -->
                        </nav>
                    </div>
                </div><!-- .col-md-12 close -->
            </div><!-- .row close -->
        </div><!-- .container close -->
    </nav><!-- header close -->
    <!--Header end-->
    <div>
        <button type="button" class="btn btn-info m-2" style="float: right;" onclick="MissingPersonListPage()">Back to List</button>
        @*@Html.ActionLink("Back to List", "ManageMissingPerson")*@
    </div>
    <div class="col-md-10" style="padding-left: 330px">
        <div class="bg-light rounded h-100 p-4">
            @using (Html.BeginForm("UpdateMissingPerson", "MissingPerson", FormMethod.Post, new { enctype = "multipart/form-data" }))
            {
                {
                    @Html.AntiForgeryToken()

            <div class="form-horizontal">
                <h4>Update Missing Person</h4>
                <hr />
                @Html.ValidationSummary(true, "", new { @class = "text-danger" })

                <div class="form-group">

                    <div class="col-md-4" style="padding-left: 71px;">@Html.LabelFor(model => model.FirstName, "First Name")</div>
                    <div class="col-md-8">
                        @Html.EditorFor(model => model.FirstName, new { htmlAttributes = new { @class = "form-control" } })
                        @Html.ValidationMessageFor(model => model.FirstName, "", new { @class = "text-danger" })
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-md-4" style="padding-left: 71px;">
                        @Html.LabelFor(model => model.LastName, "Family Name")
                    </div>
                    <div class="col-md-8">
                        @Html.EditorFor(model => model.LastName, new { htmlAttributes = new { @class = "form-control" } })
                        @Html.ValidationMessageFor(model => model.LastName, "", new { @class = "text-danger" })
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-md-4" style="padding-left: 71px;">
                        @Html.LabelFor(model => model.DateOfBirth, "Date Of Birth")
                    </div>
                    <div class="col-md-8">
                        <input type="date" name="DateOfBirth" id="DateOfBirth" class="form-control" placeholder="dd-MM-yyyy" />
                        @Html.ValidationMessageFor(model => model.DateOfBirth, "", new { @class = "text-danger" })
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-md-4" style="padding-left: 71px;">
                        @Html.LabelFor(model => model.Address, "Address")
                    </div>
                    <div class="col-md-8">
                        @Html.EditorFor(model => model.Address, new { htmlAttributes = new { @class = "form-control" } })
                        @Html.ValidationMessageFor(model => model.Address, "", new { @class = "text-danger" })
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-md-4" style="padding-left: 71px;">
                        @Html.LabelFor(model => model.FatherName, "Father Name")
                    </div>
                    <div class="col-md-8">
                        @Html.EditorFor(model => model.FatherName, new { htmlAttributes = new { @class = "form-control" } })
                        @Html.ValidationMessageFor(model => model.FatherName, "", new { @class = "text-danger" })
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-md-4" style="padding-left: 71px;">
                        @Html.LabelFor(model => model.MotherName, "Mother Name")
                    </div>
                    <div class="col-md-8">
                        @Html.EditorFor(model => model.MotherName, new { htmlAttributes = new { @class = "form-control" } })
                        @Html.ValidationMessageFor(model => model.MotherName, "", new { @class = "text-danger" })
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-md-4" style="padding-left: 71px;">
                        @Html.LabelFor(model => model.SpouseName, "Spouse Name")
                    </div>
                    <div class="col-md-8">
                        @Html.EditorFor(model => model.SpouseName, new { htmlAttributes = new { @class = "form-control" } })
                        @Html.ValidationMessageFor(model => model.SpouseName, "", new { @class = "text-danger" })
                    </div>
                </div>
                <div class="form-group">
                    <img src="" id="imageid" width="200" class="center" />
                </div>
                <div class="form-group">
                    <div class="col-md-4" style="padding-left: 71px;">
                        <label asp-for="File" class="control-label"></label>
                    </div>
                    <div class="col-md-8">
                        <div class="custom-file">
                            <input asp-for="File" class="custom-file-input" id="customFile" onchange="loadImageFile(event)">
                            <label class="custom-file-label" for="customFile">Choose file</label>
                        </div>
                        <span asp-validation-for="File" class="text-danger"></span>
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-md-4" style="padding-left: 71px;">
                        @Html.LabelFor(model => model.MissingDate, "Missing Date")
                    </div>
                    <div class="col-md-8">
                        <input type="date" name="MissingDate" id="MissingDate" class="form-control" placeholder="dd-MM-yyyy" />
                        @Html.ValidationMessageFor(model => model.MissingDate, "", new { @class = "text-danger" })
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-5" style="padding-left: 71px;">
                        <label>Publish on Facebook</label>
                    </div>
                    <div class="col-md-7">
                        <label class="switch">
                            <input type="checkbox" id="facebookCheckbox" data-val="true" value="true" name="PublishonFacebook">
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <input name="PublishonFacebook" type="hidden" value="false" />
                </div>
                <div class="form-group">
                    <div class="col-md-5" style="padding-left: 71px;">
                        <label>Publish on Twitter</label>
                    </div>
                    <div class="col-md-7">
                        <label class="switch">
                            <input type="checkbox" id="twitterCheckbox" name="PublishonTwitter" data-val="true" value="true">
                            <span class="slider round"></span>
                        </label>
                    </div>
                    <input name="PublishonTwitter" type="hidden" value="false" />
                </div>
                <input type="hidden" name="Id" id="missingPersonId" class="form-control" hidden />
                <div class="form-group">
                    <div class="col-md-offset-2 col-md-10" style="padding-left: 169px;">
                        <input type="submit" value="Update" class="btn btn-info" style="" />
                    </div>
                </div>
            </div>
                }
                }
            </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script src="~/js/bootstrap.js"></script>

    <script>

        $(document).ready(function () {
            debugger;

            let id = @Html.Raw(Json.Serialize(ViewData["Id"]));

            if (id > 0)
            {
                $.ajax({
                    url: window.location.origin + "/MissingPerson/GetMissingPersonDetailById?id=" + id,
                    success: function (result) {
                        debugger;

                        let dob, missingDate;

                        if (result.data.dateOfBirth != null)
                        {
                            dob = result.data.dateOfBirth.split('T')[0];
                        }

                        if (result.data.missingDate != null) {
                            missingDate = result.data.missingDate.split('T')[0];
                        }

                        $("#missingPersonId").val(result.data.id);
                        $("#FirstName").val(result.data.firstName);
                        $("#LastName").val(result.data.lastName);
                        $("#DateOfBirth").val(dob);
                        $("#Address").val(result.data.address);
                        $("#FatherName").val(result.data.fatherName);
                        $("#MotherName").val(result.data.motherName);
                        $("#SpouseName").val(result.data.spouseName);
                        $("#MissingDate").val(missingDate);
                        var image = document.getElementById('imageid');
                        image.src = "/Image/MissingPeopleImages/" + result.data.imageName;

                        if (result.data.publishonFacebook)
                        {
                            $('#facebookCheckbox').prop('checked', true);
                        }

                        if (result.data.publishonTwitter)
                        {
                            $('#twitterCheckbox').prop('checked', true);
                        }

                        var file = document.getElementById('customFile');
                        file.src = result.data.imagePath + result.data.imageName;
                    }
                });
            }

            $('#customFile').on('change', function () {
                //get the file name
                var fileName = $(this).val();
                //replace the "Choose a file" label
                $(this).next('.custom-file-label').html(fileName);
            });

        });

        function loadImageFile(evnt)
        {
            var image = document.getElementById('imageid');
            image.src = URL.createObjectURL(event.target.files[0]);

            document.getElementById('customFile').value = this.value.split('\\').pop().split('/').pop();
        }

        function MissingPersonListPage() {
                window.location.href = window.location.origin + "/MissingPerson/ManageMissingPerson";
        }
    </script>



